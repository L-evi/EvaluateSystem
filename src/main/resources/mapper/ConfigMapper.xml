<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.evaluate.dao.ConfigDao">
    <insert id="insertConfig"
            useGeneratedKeys="true"
            keyProperty="ID"
            parameterType="com.project.evaluate.entity.Config">
        INSERT INTO config(ID, teachingDocRoot, shareDocRoot, maxDocStorage, maxFileSize, allowFileType, pwdForgotTips,
                           userID)
        VALUES (#{ID}, #{teachingDocRoot}, #{shareDocRoot}, #{maxDocStorage}, #{maxFileSize}, #{allowFileType},
                #{pwdForgotTips}, #{userID})
    </insert>
    <update id="updateConfig">
        UPDATE config
        <set>
            <if test="teachingDocRoot != null and teachingDocRoot != ''">
                teachingDocRoot = #{teachingDocRoot},
            </if>
            <if test="shareDocRoot != null and shareDocRoot != ''">
                shareDocRoot = #{shareDocRoot},
            </if>
            <if test="maxDocStorage != null">
                maxDocStorage = #{maxDocStorage},
            </if>
            <if test="maxFileSize != null">
                maxFileSize = #{maxFileSize},
            </if>
            <if test="allowFileType != null and allowFileType != ''">
                allowFileType = #{allowFileType},
            </if>
            <if test="pwdForgotTips != null and pwdForgotTips != ''">
                pwdForgotTips = #{pwdForgotTips},
            </if>
            <if test="userID != null and userID !=''">
                userID = #{userID}
            </if>
        </set>
        WHERE ID = #{ID}
    </update>
    <delete id="deleteConfig">
        DELETE
        FROM config
        WHERE ID = #{ID}
          AND userID = #{userID}
    </delete>

    <select id="selectByID" resultType="com.project.evaluate.entity.Config">
        SELECT ID,
               teachingDocRoot,
               shareDocRoot,
               maxDocStorage,
               maxFileSize,
               allowFileType,
               pwdForgotTips,
               userID
        FROM config
        WHERE ID = #{ID}
    </select>
    <select id="selectPageConfig" resultType="com.project.evaluate.entity.Config">
        SELECT ID,
               teachingDocRoot,
               shareDocRoot,
               maxDocStorage,
               maxFileSize,
               allowFileType,
               pwdForgotTips,
               userID
        FROM config
    </select>
    <select id="selectByUserID" resultType="com.project.evaluate.entity.Config">
        SELECT ID,
               teachingDocRoot,
               shareDocRoot,
               maxDocStorage,
               maxFileSize,
               allowFileType,
               pwdForgotTips,
               userID
        FROM config
        WHERE userID = #{userID}
    </select>
    <select id="selectDefault" resultType="com.project.evaluate.entity.Config">
        SELECT ID,
               teachingDocRoot,
               shareDocRoot,
               maxDocStorage,
               maxFileSize,
               allowFileType,
               pwdForgotTips,
               userID
        FROM config
        WHERE userID IS NULL
        ORDER BY ID DESC
        LIMIT 1
    </select>
</mapper>